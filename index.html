<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AURAA - Your AI Companion</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');
        :root {
            --font-family: 'Roboto', sans-serif;
            --border-radius: 20px;
        }
        .theme-aura {
            --primary-glow: #8A2BE2; --secondary-glow: #00BFFF; --bg-color: #121212;
            --surface-color: #1e1e1e; --font-color: #e0e0e0; --muted-font-color: #aaa;
            --user-msg-bg: linear-gradient(45deg, #0052D4, #4364F7, #6FB1FC); --bot-msg-bg: #282828;
            --header-bg: linear-gradient(45deg, var(--primary-glow), var(--secondary-glow));
            --border-color: var(--primary-glow); --shadow-color: var(--primary-glow);
            --icon-color: #e0e0e0; --icon-hover-color: var(--secondary-glow);
        }
        body {
            font-family: var(--font-family); margin: 0; padding: 0;
            background-color: var(--bg-color); color: var(--font-color); display: flex;
            justify-content: center; align-items: center; min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }
        #chat-container {
            width: 95%; max-width: 800px; height: 90vh; max-height: 850px;
            background-color: var(--surface-color); border-radius: var(--border-radius);
            box-shadow: 0 5px 25px var(--shadow-color); border: 1px solid var(--border-color);
            display: flex; flex-direction: column; overflow: hidden;
        }
        #chat-header {
            background: var(--header-bg); color: white; padding: 15px 20px;
            text-align: center; font-size: 1.5em; font-weight: 700; display: flex;
            justify-content: space-between; align-items: center; text-shadow: 0 0 5px rgba(0,0,0,0.5);
        }
        #chat-messages {
            flex-grow: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px;
        }
        .message {
            padding: 12px 18px; border-radius: var(--border-radius); max-width: 80%;
            line-height: 1.5; animation: fadeInMessage 0.5s ease-out forwards;
        }
        @keyframes fadeInMessage { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .user-message { background: var(--user-msg-bg); color: white; align-self: flex-end; border-bottom-right-radius: 5px; }
        .auraa-message { background-color: var(--bot-msg-bg); color: var(--font-color); align-self: flex-start; border-bottom-left-radius: 5px; }
        .message-timestamp { font-size: 0.7em; color: var(--muted-font-color); margin-top: 8px; }
        .user-message .message-timestamp { align-self: flex-end; }
        .auraa-message .message-timestamp { align-self: flex-start; }
        #input-area { display: flex; padding: 15px; border-top: 1px solid var(--border-color); }
        #user-input {
            flex-grow: 1; padding: 12px 20px; border: 1px solid var(--border-color);
            border-radius: 25px; margin-right: 10px; font-size: 1em;
            background-color: var(--surface-color); color: var(--font-color); outline: none;
        }
        #send-button { background: none; border: none; color: var(--primary-glow); cursor: pointer; padding: 10px 12px; }
        .typing-indicator { display: none; align-items: center; padding: 10px 20px; color: var(--muted-font-color); }
        .typing-indicator span { height: 8px; width: 8px; background-color: var(--secondary-glow); border-radius: 50%; display: inline-block; margin: 0 2px; animation: bounce 1.4s infinite ease-in-out both; }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }
    </style>
</head>
<body>
    <div id="chat-container" class="theme-aura">
        <div id="chat-header">AURAA</div>
        <div id="chat-messages">
             <div class="typing-indicator"><span></span><span></span><span></span></div>
        </div>
        <div id="input-area">
            <input type="text" id="user-input" placeholder="Ask AURAA anything...">
            <button id="send-button" title="Send">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"/></svg>
            </button>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chat-messages');
        const userInputField = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const typingIndicator = document.querySelector('.typing-indicator');

        function addMessage(text, sender) {
            const messageWrapper = document.createElement('div');
            messageWrapper.classList.add('message', `${sender}-message`);

            // Use innerHTML to correctly render newlines from the AI
            const textNode = document.createElement('div');
            textNode.innerHTML = text.replace(/\n/g, '<br>');
            messageWrapper.appendChild(textNode);
            
            const timestamp = document.createElement('div');
            timestamp.classList.add('message-timestamp');
            timestamp.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            messageWrapper.appendChild(timestamp);

            chatMessages.insertBefore(messageWrapper, typingIndicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTyping() { typingIndicator.style.display = 'flex'; chatMessages.scrollTop = chatMessages.scrollHeight; }
        function hideTyping() { typingIndicator.style.display = 'none'; }
        
        async function getAuraaResponse(userInput) {
            // **IMPORTANT**: Replace this URL with your own public Render URL in the final step!
            const backendUrl = 'https://auraa-sb-2007.onrender.com'; 
            try {
                const response = await fetch(backendUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt: userInput })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    return `Error from server: ${errorData.response || 'Could not connect.'}`;
                }

                const data = await response.json();
                return data.response; // This is the pure response from me, Gemini

            } catch (error) {
                console.error("Connection Error:", error);
                return "I'm having trouble connecting to my core systems. Please ensure the backend server is running and the URL is correct.";
            }
        }

        async function handleUserInput() {
            const userInput = userInputField.value.trim();
            if (userInput === "") return;
            addMessage(userInput, 'user');
            userInputField.value = "";
            showTyping();
            const auraaResponse = await getAuraaResponse(userInput);
            hideTyping();
            addMessage(auraaResponse, 'auraa');
        }

        sendButton.addEventListener('click', handleUserInput);
        userInputField.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleUserInput();
        });

        window.onload = () => {
            userInputField.focus();
            setTimeout(() => {
                addMessage("I'm online and connected to my core AI. What can I help you with?", 'auraa');
            }, 500);
        };
    </script>
</body>
</html>
